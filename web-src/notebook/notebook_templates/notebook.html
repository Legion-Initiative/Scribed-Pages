{% extends 'base.html' %}
{%  load static %}
{% block body %}
    <div class="container">
    {% if user.is_authenticated %}
        <br>
        <div class="row">
        <div class="col-10">
            <h1 class="display-3">{{ notebook.name }}</h1>
        </div>
{#        <div class="col-2 grey-text">#}
{#            <a href="" class="btn btn-outline-success" data-toggle="modal" data-target="#article_creation"> <i class="fa fa-plus display-3"></i></a>#}
{#        </div>#}
        </div>
        <br><hr><br>

            <p class="display-1"> <b>Author</b> - {{ notebook.owner.get_full_name }}</p>
        <br><br>
        <div class="container">
            {{ notebook.description | safe }}
        </div>


        <div class="container">
            {% if articles %}
                <br>
              <ul class="messages">

                {% for article in articles %}


    <audio name="{{ article.id }}" preload= 'auto' controls  type="audio/mpeg"  src="{% static 'speech.mp3' %}"  ></audio>


    <button  id='playfile' value = 'Play' name="{{ article.id }}" >Play</button>


                  <div class="alert alert-danger alert-dismissible fade show" role="alert">
                    <h3>{{ article.title | safe }}</h3>
                    <strong name="{{ article.id }}">{{ article.content | safe}}</strong>
                   </div>
                {% endfor %}

              </ul>
            {% endif %}

        </div>
        {% include 'article_creation.html' %}
</div>

    {% endif %}
    </div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>


    <script>

function submit(text,id){

var playBtn = $("button[name="+id+"]");
var audioBtn = $("audio[name="+id+"]");
$.ajax({
    url: "{% url 'getAudio' %}",
    type: "post",
    data: {
        text : text,

    },
   beforeSend:function(){
     playBtn.html("Wait...");
   },
    success: function(){
    playBtn.html("Playing");
            {% load static %}
    audioBtn.src = "{% static 'speech.mp3' %}";
    audioBtn[0].play();

    },
    error:function(){
        alert("Error occured");
    }
});

}

    </script>
    <script>
                {% for article in articles %}
    $('button[name ="{{ article.id }}"]').click(function(event){
        event.preventDefault();
        console.log("submitted!")
        var text = $('strong[name ="{{ article.id }}"]').html()
        submit(text,{{ article.id }});
    });
    {% endfor %}
    </script>

{% endblock %}